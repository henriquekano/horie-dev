<HTML>
<HEAD>
<META name=vsisbn content="0471503363">
<META name=vstitle content="Art of Computer Systems Performance Analysis Techniques For Experimental Design Measurements Simulation And Modeling">
<META name=vsauthor content="Raj Jain">
<META name=vsimprint content="Wiley Computer Publishing">
<META name=vspublisher content="John Wiley & Sons, Inc.">
<META name=vspubdate content="05/01/91">
<META name=vscategory content="Web and Software Development: Software Engineering: Simulation and Modeling">







<TITLE>The Art of Computer Systems Performance Analysis: Techniques for Experimental Design, Measurement, Simulation, and Modeling:Random-Number Generation</TITLE>

<!-- HEADER -->

<STYLE type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
</STYLE>

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">

<!--ISBN=0471503363//-->
<!--TITLE=The Art of Computer Systems Performance Analysis: Techniques for Experimental Design, Measurement, Simulation, and Modeling//-->
<!--AUTHOR=Raj Jain//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=26//-->
<!--PAGES=447-450//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-05.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
</P>
<P>Here, <I>s</I> is a constant greater than or equal to <I>l</I> and is relatively prime to 2<I><SUP><SMALL>q</SMALL></SUP></I>-1. The first restriction, <I>s</I> &#8805; <I>l</I>, ensures that <I>x<SUB><SMALL>n</SMALL></SUB></I> and <I>x<SUB><SMALL>j</SMALL></SUB></I> for <I>n</I> &#8800 <I>j</I> have no bits in common. The second restriction of relative primeness guarantees a full period 2<SUP><SMALL><I>q</I></SMALL></SUP> - 1 for <I>x<SUB><SMALL>n</SMALL></SUB></I>. The following example illustrates this procedure for constructing <I>l</I>-bit words.</P>
<DL>
<DD><B>Example 26.5</B> Consider generation of 8-bit random numbers from the binary sequence of Example 26.4. The period 2<SUP><SMALL>7</SMALL></SUP> - 1 = 127 is a prime number. Therefore, any value of i greater than or equal to <I>l</I> = 8 can be used. Using <I>s</I> = 8, the successive 8-bit random numbers obtained are as follows:
<P ALIGN="CENTER"><I>x</I><SUB>0</SUB> = 0.11111110<SUB>2</SUB> = 0.99219<SUB>10</SUB>
<P ALIGN="CENTER"><I>x</I><SUB>1</SUB> = 0.00011101<SUB>2</SUB> = 0.11328<SUB>10</SUB>
<P ALIGN="CENTER"><I>x</I><SUB>2</SUB> = 0.11100101<SUB>2</SUB> = 0.89453<SUB>10</SUB>
<P ALIGN="CENTER"><I>x</I><SUB>3</SUB> = 0.10010010<SUB>2</SUB> = 0.29688<SUB>10</SUB>
<P ALIGN="CENTER"><I>x</I><SUB>4</SUB> = 0.00000100<SUB>2</SUB> = 0.36328<SUB>10</SUB>
<P ALIGN="CENTER"><I>x</I><SUB>5</SUB> = 0.01001100<SUB>2</SUB> = 0.42188<SUB>10</SUB>
<P ALIGN="CENTER"><P ALIGN="CENTER"><IMG SRC="images/26-02d.jpg"></P>
<DD>The numbers in the middle are binary, and those on the right are the corresponding decimal numbers.
</DL>
<P>Tausworthe showed that the <I>l</I>-bit numbers generated using Equation (26.10) had the following property:</P>
<DL>
<DD><B>1.</B>&nbsp;&nbsp;The mean of the sequence is <IMG SRC="images/26-02i.jpg"></IMGI>
</DL>
<P ALIGN="CENTER"><P ALIGN="CENTER"><IMG SRC="images/26-03d.jpg"></P>
</P>
<DL>
<DD><B>2.</B>&nbsp;&nbsp;The variance of the sequence is <IMG SRC="images/26-03i.jpg"></IMGI>
</DL>
<P ALIGN="CENTER"><P ALIGN="CENTER"><IMG SRC="images/26-04d.jpg"></P>
</P>
<DL>
<DD><B>3.</B>&nbsp;&nbsp;The serial correlation is zero:
</DL>
<P ALIGN="CENTER"><P ALIGN="CENTER"><IMG SRC="images/26-05d.jpg"></P>
</P>
<DL>
<DD><B>4.</B>&nbsp;&nbsp;The sequence is <I>k</I> distributed for all <I>k</I>&#146;s up to <FONT FACE="SYMBOL">&#0235;</FONT><I>q/l</I><FONT FACE="SYMBOL">&#0251;</FONT>. Briefly, this means that every <I>k</I>-tuple of <I>l</I>-bit numbers appears 2<I><SUP><SMALL>q-kl</SMALL></SUP></I> times over the full. period except the all-zero tuple, which appears one time less. The <I>k</I>-distributivity property is explained further in Section 27.5.
</DL>
<P>Using <I>k</I> = 1 and <I>l</I> = 1 in the last property, it follows that the complete period of the bit sequence contains 2<I><SUP><SMALL>q</I>-1</SMALL></SUP> ones and 2<I><SUP><SMALL>q</I>-1</SMALL></SUP> - 1 zeros. Also, if a window of length <I>q</I> slides along the sequence, each of the 2<I><SUP><SMALL>q</SMALL></SUP></I> - 1 nonzero <I>k</I>-tuples appears exactly once in a complete period.</P>
<P>Most of the polynomials used for generating Tausworthe sequences are trinomials, that is, they have just three nonzero terms. In this case, generation of each new bit requires just one exclusive-or operation. For example, if only <I>c<SUB>r</SUB></I> and <I>c</I><SUB>0</SUB> are 1 and all other <I>c<SUB>i</SUB></I>&#146; are zero, then</P>
<TABLE WIDTH="100%"><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="25%">
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="65%"><I>b<SUB>n</SUB></I> = <I>b<SUB>n-q&#43;r</SUB></I> &#8853; <I>b<SUB>n-q</SUB></I>
<TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">(26.11)
</TABLE>
<P>This makes the computation of bits <I>b<SUB>i</SUB></I> fast. However, to get random numbers, we still need to generate several bits. One way to simple random-number generation is to choose <I>r</I> and <I>q</I> such that 2<I>r</I> &#8804; <I>q</I>. In this case, one can generate successive <I>q</I>-bits by using the following shift and an exclusive-or sequence. The individual bits in a word are read from the right. For example, the seed word would be <I>b<SUB><SMALL>q</I>-1</SMALL></SUB><I>b</I><SUB><SMALL>q-2</SMALL></SUB>...<I>b</I><SUB><SMALL>0</SMALL></SUB>.</P>
<DL>
<DD><B>1.</B>&nbsp;&nbsp;Start with a <I>q</I>-bit seed <I>Y</I><SUB><SMALL>1</SMALL></SUB>.
<DD><B>2.</B>&nbsp;&nbsp;Right shift <I>Y</I><SUB><SMALL>1</SMALL></SUB> by <I>r</I> bits, filling with zeros on the left. Call the result <I>Y</I><SUB><SMALL>2</SMALL></SUB>.
<DD><B>3.</B>&nbsp;&nbsp;Exclusive-or <I>Y</I><SUB><SMALL>1</SMALL></SUB> and <I>Y</I><SUB><SMALL>2</SMALL></SUB>. Call the result <I>Y</I><SUB><SMALL>3</SMALL></SUB>. This completes the computation of the right <I>q</I> - <I>r</I> bits.
<DD><B>4.</B>&nbsp;&nbsp;Left shift <I>Y</I><SUB><SMALL>3</SMALL></SUB> by <I>q</I> - <I>r</I> bits, filling with zeros on the right. Call the result <I>Y</I><SUB><SMALL>4</SMALL></SUB>
<DD><B>5.</B>&nbsp;&nbsp;Exclusive-or <I>Y</I><SUB><SMALL>3</SMALL></SUB> and <I>Y</I><SUB><SMALL>4</SMALL></SUB>. The result <I>Y</I><SUB><SMALL>5</SMALL></SUB> is the new <I>q</I>-bit seed.
</DL>
<P>The following example illustrates the procedure.
</P>
<DL>
<DD><B>Example 26.6</B> Consider the generation of 7-bit random numbers using the trinomial of Example 26.4:
<P ALIGN="CENTER"><I>x</I><SUP><SMALL>7</SMALL></SUP> &#43; <I>x</I><SUP><SMALL>3</SMALL></SUP> &#43; 1
<DD>In this case, <I>r</I> = 3, <I>q</I> = 7, and <I>q</I> - <I>r</I> = 4. Therefore, we need a 3-bit right shift and a 4-bit left shift. Once again we start with a seed <I>X</I> = 1111111. The steps to generate the next 7 bits are as follows:
<DL>
<DL>
<DL>
<DD>Step 1: Copy seed, <I>Y</I><SUB><SMALL>1</SMALL></SUB> = <I>X</I> = 1111111.
<DD>Step 2: Right shift by 3, <I>Y</I><SUB><SMALL>2</SMALL></SUB> = 0001111.
<DD>Step 3: Exclusive-or, <I>Y</I><SUB><SMALL>3</SMALL></SUB> = <I>Y</I><SUB><SMALL>1</SMALL></SUB> &#8853; <I>Y</I><SUB><SMALL>2</SMALL></SUB> = 1110000.
<DD>Step 4: Left shift by 4, <I>Y</I><SUB><SMALL>4</SMALL></SUB> = 0000000.
<DD>Step 5: Exclusive-or, <I>Y</I><SUB><SMALL>5</SMALL></SUB> = <I>Y</I><SUB><SMALL>3</SMALL></SUB> &#8853; <I>Y</I><SUB><SMALL>4</SMALL></SUB> = 1110000.
</DL>
</DL>
</DL>
<DD>The next 7 bits (read from the right) are 0000111. The process can then be repeated:
<DL>
<DL>
<DL>
<DD>Step 1: Copy seed, <I>Y</I><SUB><SMALL>1</SMALL></SUB> = <I>X</I> = 1110000.
<DD>Step 2: Right shift by 3, <I>Y</I><SUB><SMALL>2</SMALL></SUB> = 0001110.
<DD>Step 3: Exclusive-or, <I>Y</I><SUB><SMALL>3</SMALL></SUB> = <I>Y</I><SUB><SMALL>1</SMALL></SUB> &#8853; <I>Y</I><SUB><SMALL>2</SMALL></SUB> =1111110.
<DD>Step 4: Left shift by 4, <I>Y</I><SUB><SMALL>4</SMALL></SUB> = 1100000.
<DD>Step 5: Exclusive-or, <I>Y</I><SUB><SMALL>5</SMALL></SUB> = <I>Y</I><SUB><SMALL>3</SMALL></SUB> &#8853; <I>Y</I><SUB><SMALL>4</SMALL></SUB> = 0011110.
</DL>
</DL>
</DL>
<DD>The next 7 bits (read from the right) are 0111100. As a check, we verify that the bit sequence is the same as that in Example 26.4.
</DL>
<P>If <I>q</I> is equal to the number of bits in the computer word (not counting the sign bit), the generation of <I>q</I>-bit words using the word-wide shift and exclusive-or instructions is straightforward. For a large <I>q</I>, the shifting procedure can be implemented in hardware. A list of primitive trinomials of degree 31 or less is given in Table 26.1.</P>
<P>A disadvantage of Tausworthe generators is the observation by Tootill et al. (1971) that while the sequence may produce good test results over the complete cycle, it may not have satisfactory local behavior. In particular, it performed negatively on the runs up and down test. Although the first-order serial correlation is almost zero, it is suspected that some primitive polynomials may give poor high-order correlations. Later, in Section 27.5, it is shown that not all primitive polynomials are equally good.</P>
<P>To construct <I>l</I>-bit random numbers <I>x<SUB><SMALL>n</SMALL></SUB></I> from the binary sequence <I>b<SUB><SMALL>n</SMALL></SUB></I>, Lewis and Payne (1973) proposed a slightly different method than that proposed by Tausworthe. In this method, called the <B>Generalized Feedback Shift Register (GFSR)</B>, an l-bit sequence <I>x<SUB><SMALL>n</SMALL></SUB></I> is generated from the binary sequence as follows:</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 0.<I>b<SUB><SMALL>n</SMALL></SUB>b<SUB><SMALL>n&#43;s</SMALL></SUB>b<SUB><SMALL>n</I>&#43;2<I>s</I></SMALL></SUB>...<I>b<SUB><SMALL>n</I>&#43;(<I>l</I>-1)<I>s</I></SMALL></SUB></P>
<P>Here, <I>s</I> is a &#147;carefully selected delay.&#148; The key advantage of their idea is that the sequence <I>x<SUB><SMALL>n</SMALL></SUB></I> can be generated very efficiently using word-wide shift and exclusive-or instructions. However, it requires that an array of numbers be stored and that careful initialization of this array take place.</P>
<TABLE WIDTH="100%"><TH CAPTION COLSPAN="4" ALIGN="LEFT">TABLE 26.1 List of Primitive Trinomials<SUP><SMALL><B>a</B></SMALL></SUP><TR>
<TD COLSPAN="4"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>2</SMALL></SUP> &#43; <I>x</I> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>3</SMALL></SUP> &#43; <I>x</I> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>4</SMALL></SUP> &#43; <I>x</I> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>5</SMALL></SUP> &#43; <I>x</I>2 &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>6</SMALL></SUP> &#43; x &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>7</SMALL></SUP> &#43; <I>x</I><SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>7</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>9</SMALL></SUP> &#43; <I>x</I><SUP>4</SUP> &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>10</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>11</SMALL></SUP> &#43; <I>x</I><SUP>2</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>15</SMALL></SUP> &#43; <I>x</I> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>15</SMALL></SUP> &#43; x1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>15</SMALL></SUP> &#43; <I>x</I><SUP>7</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>17</SMALL></SUP>7 &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>17</SMALL></SUP> &#43; <I>x</I><SUP>5</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>17</SMALL></SUP> &#43; <I>x</I><SUP>6</SUP> &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>18</SMALL></SUP> &#43; <I>x</I><SUP>7</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>20</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>21</SMALL></SUP> &#43; <I>x</I><SUP>2</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>22</SMALL></SUP> &#43; <I>x</I> &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>23</SMALL></SUP> &#43; <I>x</I><SUP>5</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>23</SMALL></SUP> &#43; <I>x</I><SUP>9</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>25</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>25</SMALL></SUP> &#43; <I>x</I><SUP>7</SUP> &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>28</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>28</SMALL></SUP> &#43; <I>x</I><SUP>9</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>28</SMALL></SUP> &#43; <I>x</I><SUP>13</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>29</SMALL></SUP> &#43; <I>x</I><SUP>2</SUP> &#43; 1
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>31</SMALL></SUP> &#43; <I>x</I><SUP>3</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>31</SMALL></SUP> &#43; <I>x</I><SUP>6</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>31</SMALL></SUP> &#43; <I>x</I><SUP>7</SUP> &#43; 1
<TD VALIGN="TOP" ALIGN="LEFT"><I>x</I><SUP><SMALL>31</SMALL></SUP> &#43; <I>x</I><SUP>13</SUP> &#43;1
<TR>
<TD COLSPAN="4"><HR>
</TABLE>

<BLOCKQUOTE>
<HR>
<SUP><SMALL><B>a</B></SMALL></SUP><FONT SIZE="-1">If x<SUP><I>q</I></SUP> &#43; x<SUP><I>r</I></SUP> &#43; 1 is listed, then x<SUP><I>q</I></SUP> &#43; x<SUP><I>q-r</I></SUP> &#43;1 is also primitive.
</FONT>
<HR>
</BLOCKQUOTE>

<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-05.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>

<hr width="90%" size="1" noshade>
<div align="center">
<font face="Verdana,sans-serif" size="1">Copyright &copy; <a href="/reference/wiley00001.html">John Wiley &amp; Sons, Inc.</a></font>
</div>
<!-- all of the reference materials (books) have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

</BODY>
</HTML>

<!-- END FOOTER -->

