<HTML>
<HEAD>
<META name=vsisbn content="0471503363">
<META name=vstitle content="Art of Computer Systems Performance Analysis Techniques For Experimental Design Measurements Simulation And Modeling">
<META name=vsauthor content="Raj Jain">
<META name=vsimprint content="Wiley Computer Publishing">
<META name=vspublisher content="John Wiley & Sons, Inc.">
<META name=vspubdate content="05/01/91">
<META name=vscategory content="Web and Software Development: Software Engineering: Simulation and Modeling">







<TITLE>The Art of Computer Systems Performance Analysis: Techniques for Experimental Design, Measurement, Simulation, and Modeling:Random-Number Generation</TITLE>

<!-- HEADER -->

<STYLE type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
</STYLE>

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">

<!--ISBN=0471503363//-->
<!--TITLE=The Art of Computer Systems Performance Analysis: Techniques for Experimental Design, Measurement, Simulation, and Modeling//-->
<!--AUTHOR=Raj Jain//-->
<!--PUBLISHER=Wiley Computer Publishing//-->
<!--CHAPTER=26//-->
<!--PAGES=450-453//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H3><A NAME="Heading8"></A><FONT COLOR="#000077">26.4 EXTENDED FIBONACCI GENERATORS</FONT></H3>
<P>A Fibonacci sequence {<I>x<SUB><SMALL>n</SMALL></SUB></I>} is generated by the following relationship:</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = <I>x<SUB><SMALL>n</I>-1</SMALL></SUB> &#43; <I>x<SUB><SMALL>n</I>-2</SMALL></SUB></P>
<P>The generation of random numbers can be attempted by using the following modification to the Fibonnaci sequence:</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = <I>x<SUB><SMALL>n</I>-1</SMALL></SUB> &#43; <I>x<SUB><SMALL>n</I>-2</SMALL></SUB> mod <I>m</I></P>
<P>However, this sequence does not have good randomness properties. In particular, it has a high serial correlation. An extension of this approach would be to combine, for instance, the fifth and seventeenth most recent values:</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = <I>x<SUB><SMALL>n</I>-5</SMALL></SUB> &#43; <I>x<SUB><SMALL>n</I>-17</SMALL></SUB> mod 2<I><SUP>k</SUP></I></P>
<P>Marsaglia (1983) points out that this generator passes most statistical tests and recommends its implementation as follows using 17 storage locations <I>L</I>[1]...., <I>L</I>[17]. During initialization, fill these locations with 17 integers, not all even, and set two pointers <I>i</I> and <I>j</I> to 17 and 5, respectively. On each successive call, the following procedure is executed, which returns the next random number and updates the pointers:</P>
<DL>
<DL>
<DL>
<DD><I>x</I>:= <I>L</I>[<I>i</I>] &#43; <I>L</I>[<I>j</I>];
<DD><I>L</I>[<I>i</I>]:= <I>x</I>;
<DD><I>i</I>:= <I>i</I>-1; IF <I>i</I> = 0 THEN <I>i</I>:= 17;
<DD><I>j</I>:= <I>j</I> - 1; IF <I>j</I> = 0 THEN <I>j</I>:= 17
<DD>Return <I>x</I>;
</DL>
</DL>
</DL>
<P>The add operation in the first line of this generator is automatically mod 2<I><SUP>k</SUP></I> in <I>k</I>-bit machines with 2&#146;s complement arithmetic. The period of the generator is 2<I><SUP>k</SUP></I>(2<SUP>17</SUP> - 1). For <I>k</I>, = 8 16, 32, this period is 1.6 x 10<SUP>7</SUP>, 4.3 x 10<SUP>9</SUP>, and 2.8 x 10<SUP>14</SUP>, respectively. This is considerably longer than that possible with LCGs.</P>
<H3><A NAME="Heading9"></A><FONT COLOR="#000077">26.5 COMBINED GENERATORS</FONT></H3>
<P>It is possible to combine two or more random generators to produce a &#147;better&#148; generator. Three such techniques are described next:
</P>
<DL>
<DD><B>1.</B>&nbsp;&nbsp;<I>Adding random numbers obtained by two or more generators</I>. If <I>x<SUB><SMALL>n</SMALL></SUB></I> and <I>y<SUB><SMALL>n</SMALL></SUB></I> are two random-number sequences in the range 0 and <I>m</I> - 1, they can be combined to produce <I>w<SUB><SMALL>n</SMALL></SUB></I> = (<I>x<SUB><SMALL>n</SMALL></SUB></I> &#43; <I>y<SUB><SMALL>n</SMALL></SUB></I>). If the two sequences have different periods and are obtained by different algorithms, this may considerably increase the period and randomness. For example, L&#146;Ecuyer (1988) recommends combining the following two generators:
</DL>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 40014<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod 2,147,483,563</P>
<P ALIGN="CENTER"><I>y<SUB><SMALL>n</SMALL></SUB></I> = 40692<I>y<SUB><SMALL>n</I>-1</SMALL></SUB> mod 2,147,483,399</P>
<DL>
<BR>This would produce
<P ALIGN="CENTER"><I>w<SUB><SMALL>n</SMALL></SUB></I> = (<I>x<SUB><SMALL>n</SMALL></SUB></I> - <I>y<SUB><SMALL>n</SMALL></SUB></I>) mod 2,147,483,562
<P>This generator has a period of 2.3 &#215; 10<SUP><SMALL>18</SMALL></SUP>. Also, it does not have the problem of all points in the <I>k</I>-dimension falling on a small number of hyperplanes. For 16-bit computers, L&#146;Ecuyer suggests combining the following three generators:
</DL>
<P ALIGN="CENTER"><I>w<SUB><SMALL>n</SMALL></SUB></I> = 157<I>w<SUB><SMALL>n</I>-1</SMALL></SUB> mod 32,363</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 146<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod 31,727</P>
<P ALIGN="CENTER"><I>y<SUB><SMALL>n</SMALL></SUB></I> = 142<I>y<SUB><SMALL>n</I>-1</SMALL></SUB> mod 31,657</P>
<P>This would produce</P>
<P ALIGN="CENTER"><I>v<SUB><SMALL>n</SMALL></SUB></I> = (<I>w<SUB><SMALL>n</SMALL></SUB> - x<SUB><SMALL>n</SMALL></SUB> &#43; y<SUB><SMALL>n</SMALL></SUB></I>) mod 32,363</P>
<DL>
<BR>This generator has a period of 8.1 &#215; 10<SUP><SMALL>12</SMALL></SUP>. Portable implementations of these combined generators can be found in L&#146;Ecuyer (1988).
<DD><B>2.</B>&nbsp;&nbsp;<I>Exclusive-or random numbers obtained by two or more generators</I>. This technique is similar to the previous one except that the arithmetic addition is replaced by bit-wise exclusive-or operation. Santha and Vazirani (1984) showed that the exclusive-or of several slightly random generators, each producing <I>n</I>-bit numbers, can be used to generate a more random sequence.
<DD><B>3.</B>&nbsp;&nbsp;<I>Shuffle</I>. This technique, known as shuffling, uses one sequence as an index to decide which of several numbers generated by a second sequence should be returned. Many different shuffling procedures have been suggested in the literature. One popular technique, which is credited to Marsaglia and Bray (1964), is known as algorithm M. Here, an array of size 100, for instance, is filled with random numbers from a random sequence <I>x<SUB><SMALL>n</SMALL></SUB></I>. To generate a random number, generate a new <I>Y<SUB><SMALL>n</SMALL></SUB></I> (between 0 and <I>m</I> -1) and scale it to obtain an index <I>i</I> = 1 &#43; 100<I>y<SUB><SMALL>n</SMALL></SUB></I>/<I>m</I>. The value in the <I>i</I>th element of the array is returned as the next random number. A new value of <I>x<SUB><SMALL>n</SMALL></SUB></I> is generated and stored in the it hlocation. This generator is claimed to have better <I>k</I>-distributivity properties than the generators based on LFSRs.
<BR>One problem with shuffling is that it is not easy to skip a long subsequence as is usually required in multiple-stream simulations.
</DL>
<H3><A NAME="Heading10"></A><FONT COLOR="#000077">26.6 A SURVEY OF RANDOM-NUMBER GENERATORS</FONT></H3>
<P>In this section, we describe a number of generators that have either been proposed in published literature or have been used in various simulation packages. In some cases, known problems and properties are also discussed. The list follows:
</P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;A currently popular multiplicative LCG is
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 7<SUP><SMALL>5</SMALL></SUP> <I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod(2<SUP><SMALL>31</SMALL></SUP> - 1)
<DD><B></B>&nbsp;&nbsp;This generator is used in the SIMPL/I system (IBM 1972), the APL system from IBM (Katzan 1971), the PRIMOS operating system from Prime Computer (1984), and the scientific library from IMSL (1987). Since 2<SUP><SMALL>31</SMALL></SUP> - 1 is a prime number and 7<SUP><SMALL>5</SMALL></SUP> is a primitive root of it, this generator has the full period of 2<SUP><SMALL>31</SMALL></SUP> - 2. This generator has been extensively analyzed and shown to be good. Its low-order bits are uniformly distributed. It has reasonable randomness properties. This generator was highly recommended by Park and Miller (1988), and they called it the <I>minimal standard</I>. Pascal programs to implement this generator were presented earlier in Figures 26.2 and 26.3.
<DD><B>&#149;</B>&nbsp;&nbsp;Fishman and Moore (1986) conducted an exhaustive search of all full-period, multiplicative LCGs with modulus <I>m</I> = 2<SUP><SMALL>31</SMALL></SUP> - 1 and compared them on the basis of implementation efficiency and randomness. Their conclusion was that the following two generators were the best:
</DL>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 48,271<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod(2<SUP><SMALL>31</SMALL></SUP> - 1)</P>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 69,621<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod(2<SUP><SMALL>31</SMALL></SUP> - 1)</P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;The following generator is used in SIMSCRIPT II.5 and in DEC-20 FORTRAN:
</DL>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = 630,360,016<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod(2<SUP><SMALL>31</SMALL></SUP> - 1)</P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;The following multiplicative LCG, known as &#147;RANDU&#148; (IBM 1968), was very popular in the 1960s:
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = (2<SUP><SMALL>16</SMALL></SUP> &#43; 3)<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod 2<SUP><SMALL>31</SMALL></SUP>
<DD><B></B>&nbsp;&nbsp;The modulus and the multiplier were selected primarily to facilitate easy computation. Multiplication by 2<SUP><SMALL>16</SMALL></SUP> &#43; 3 = 65,539 can be easily accomplished by a few shift and add instructions. This generator does not have a full period and has been shown to be flawed in many respects. Also, it does not have good randomness properties (Knuth, 1981). When the triplets of successive numbers generated by RANDU are plotted as points in a three-dimensional space, all the points lie on a total of 15 planes in the space. In other words, it has unsatisfactory three-distributivity (see Section 27.5 for <I>k</I>-distributivity). Also, like all LCGs with <I>m</I> = 2<I><SUP><SMALL>k</SMALL></SUP></I>, the lower order bits of this generator have a small period, which is discussed later in Section 26.8. RANDU is no longer used.
<DD><B>&#149;</B>&nbsp;&nbsp;The following analog of RANDU is sometimes recommended for 16-bit microprocessors:
</DL>
<P ALIGN="CENTER"><I>x<SUB><SMALL>n</SMALL></SUB></I> = (2<SUP><SMALL>8</SMALL></SUP> &#43; 3)<I>x<SUB><SMALL>n</I>-1</SMALL></SUB> mod(2<SUP><SMALL>15</SMALL></SUP>)</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-04.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>

<hr width="90%" size="1" noshade>
<div align="center">
<font face="Verdana,sans-serif" size="1">Copyright &copy; <a href="/reference/wiley00001.html">John Wiley &amp; Sons, Inc.</a></font>
</div>
<!-- all of the reference materials (books) have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

</BODY>
</HTML>

<!-- END FOOTER -->

